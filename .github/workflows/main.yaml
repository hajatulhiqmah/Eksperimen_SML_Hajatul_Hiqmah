name: Run Preprocessing

on:
  push:
    branches: [ main, master ] # Sesuaikan dengan nama branch utama Anda
    paths:
      - 'preprocessing/**'      # Hanya jalankan jika ada perubahan di folder preprocessing
      - 'wine_quality/**'  # Atau jika data mentah berubah

jobs:
  preprocess-data:
    runs-on: ubuntu-latest
    steps:
      # Langkah 1: Checkout kode repositori
      - name: Checkout code
        uses: actions/checkout@v3

      # Langkah 2: Siapkan lingkungan Python
      - name: Set up Python 3.9
        uses: actions/setup-python@v4
        with:
          python-version: '3.9' # Anda bisa ganti versinya

      # Langkah 3: Instal dependensi yang diperlukan skrip
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt 
          
      # Langkah 4: Jalankan skrip preprocessing
      - name: Run preprocessing script
        run: python preprocessing/automate_HajatulHiqmah.py

      # Langkah 5: Simpan dataset yang sudah diproses sebagai artifact
      # Ini memenuhi syarat "mengembalikan sebuah dataset terbaru"
      - name: Upload processed dataset artifact
        uses: stefanzweifel/git-auto-commit-action@v4
        with:
          name: processed-dataset
          file_pattern: preprocessing/dataset/wine_processed_clened.csv
          commit_user_name: "GitHub Actions Bot"
          commit_user_email: "actions@github.com"
          commit_author: "GitHub Actions Bot <actions@github.com>"
          
 
